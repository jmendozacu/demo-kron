<?xml version="1.0"?>
<!--
/**
 * Magestore
 * 
 * NOTICE OF LICENSE
 * 
 * This source file is subject to the Magestore.com license that is
 * available through the world-wide-web at this URL:
 * http://www.magestore.com/license-agreement.html
 * 
 * DISCLAIMER
 * 
 * Do not edit or add to this file if you wish to upgrade this extension to newer
 * version in the future.
 * 
 * @category    Magestore
 * @package     Magestore_SimiPOS
 * @copyright   Copyright (c) 2012 Magestore (http://www.magestore.com/)
 * @license     http://www.magestore.com/license-agreement.html
 */
-->
<config>
    <modules>
        <Magestore_SimiPOS>
            <version>0.2.4</version>
        </Magestore_SimiPOS>
    </modules>
    <frontend>
        <routers>
            <simipos>
                <use>standard</use>
                <args>
                    <module>Magestore_SimiPOS</module>
                    <frontName>simipos</frontName>
                </args>
            </simipos>
        </routers>
        <layout>
            <updates>
                <simipos>
                    <file>simipos.xml</file>
                </simipos>
            </updates>
        </layout>
        <translate>
            <modules>
                <Magestore_SimiPOS>
                    <files>
                        <default>Magestore_SimiPOS.csv</default>
                    </files>
                </Magestore_SimiPOS>
            </modules>
        </translate>
        <events>
            <customer_address_save_after>
                <observers>
                    <simipos_observers>
                        <class>simipos/observer</class>
                        <method>saveCustomerAddress</method>
                    </simipos_observers>
                </observers>
            </customer_address_save_after>
        </events>
    </frontend>
    <admin>
        <routers>
            <simiposadmin>
                <use>admin</use>
                <args>
                    <module>Magestore_SimiPOS</module>
                    <frontName>simiposadmin</frontName>
                </args>
            </simiposadmin>
        </routers>
    </admin>
    <adminhtml>
        <layout>
            <updates>
                <simipos>
                    <file>simipos.xml</file>
                </simipos>
            </updates>
        </layout>
        <translate>
            <modules>
                <Magestore_SimiPOS>
                    <files>
                        <default>Magestore_SimiPOS.csv</default>
                    </files>
                </Magestore_SimiPOS>
            </modules>
        </translate>
        <events>
            <core_block_abstract_to_html_after>
                <observers>
                    <simipos_observers>
                        <class>simipos/observer</class>
                        <method>updateInvoiceView</method>
                    </simipos_observers>
                </observers>
            </core_block_abstract_to_html_after>
            <adminhtml_customer_save_after>
                <observers>
                    <simipos_observers>
                        <class>simipos/observer</class>
                        <method>prepareSaveCustomer</method>
                    </simipos_observers>
                </observers>
            </adminhtml_customer_save_after>
        </events>
    </adminhtml>   
    <global>
        <models>
            <simipos>
                <class>Magestore_SimiPOS_Model</class>
                <resourceModel>simipos_mysql4</resourceModel>
            </simipos>
            <simipos_mysql4>
                <class>Magestore_SimiPOS_Model_Mysql4</class>
                <entities>
                    <user>
                        <table>simipos_user</table>
                    </user>
                    <session>
                        <table>simipos_session</table>
                    </session>
                    <location>
                        <table>simipos_location</table>
                    </location>
                </entities>
            </simipos_mysql4>
            <salesrule_mysql4>
                <rewrite>
                    <rule_collection>Magestore_SimiPOS_Model_Mysql4_Rule_Collection</rule_collection>
                </rewrite>
            </salesrule_mysql4>
            <salesrule>
                <rewrite>
                    <quote_discount>Magestore_SimiPOS_Model_Quote_Discount</quote_discount>
                </rewrite>
            </salesrule>
            <shipping>
                <rewrite>
                    <shipping>Magestore_SimiPOS_Model_Shipping</shipping>
                    <carrier_freeshipping>Magestore_SimiPOS_Model_Carrier_Freeshipping</carrier_freeshipping>
                </rewrite>
            </shipping>
            <cataloginventory>
                <rewrite>
                    <stock_item>Magestore_SimiPOS_Model_Stock_Item</stock_item>
                    <observer>Magestore_SimiPOS_Model_Inventory_Observer</observer>
                </rewrite>
            </cataloginventory>
        </models>
        <resources>
            <simipos_setup>
                <setup>
                    <module>Magestore_SimiPOS</module>
                </setup>
                <connection>
                    <use>core_setup</use>
                </connection>
            </simipos_setup>
            <simipos_write>
                <connection>
                    <use>core_write</use>
                </connection>
            </simipos_write>
            <simipos_read>
                <connection>
                    <use>core_read</use>
                </connection>
            </simipos_read>
        </resources>
        <blocks>
            <simipos>
                <class>Magestore_SimiPOS_Block</class>
            </simipos>
        </blocks>
        <helpers>
            <simipos>
                <class>Magestore_SimiPOS_Helper</class>
            </simipos>
        </helpers>
        <events>
            <sales_model_service_quote_submit_before>
                <observers>
                    <simipos_observers>
                        <class>simipos/observer</class>
                        <method>quoteSubmitBefore</method>
                    </simipos_observers>
                </observers>
            </sales_model_service_quote_submit_before>
            <paypal_prepare_line_items>
                <observers>
                    <simipos_observers>
                        <class>simipos/observer</class>
                        <method>paypalPrepareLineItems</method>
                    </simipos_observers>
                </observers>
            </paypal_prepare_line_items>
            <sales_quote_item_set_product>
                <observers>
                    <simipos_observers>
                        <class>simipos/observer</class>
                        <method>quoteItemSetProduct</method>
                    </simipos_observers>
                </observers>
            </sales_quote_item_set_product>
            <sales_order_payment_place_start>
                <observers>
                    <simipos_observers>
                        <class>simipos/observer</class>
                        <method>orderPaymentPlaceStart</method>
                    </simipos_observers>
                </observers>
            </sales_order_payment_place_start>
            <payment_method_is_active>
                <observers>
                    <simipos_observers>
                        <class>simipos/observer</class>
                        <method>orderPaymentMethodActive</method>
                    </simipos_observers>
                </observers>
            </payment_method_is_active>
        </events>
        <sales>
            <quote>
                <totals>
                    <simipos_cash>
                        <class>simipos/total_quote_cash</class>
                        <after>wee,discount,tax,tax_subtotal,grand_total</after>
                    </simipos_cash>
                </totals>
            </quote>
            <order_invoice>
                <totals>
                    <simipos_cash>
                        <class>simipos/total_invoice_cash</class>
                        <after>wee,discount,tax,tax_subtotal,grand_total</after>
                    </simipos_cash>
                </totals>
            </order_invoice>
			<order_creditmemo>
				<totals>
					<simipos_cash>
                        <class>simipos/total_creditmemo_cash</class>
                        <after>wee,discount,tax,tax_subtotal,grand_total</after>
                    </simipos_cash>
				</totals>
			</order_creditmemo>
        </sales>
        <pdf>
            <totals>
                <simipos_cash translate="title">
                    <title>Cash In</title>
                    <source_field>simipos_cash</source_field>
                    <model>simipos/total_pdf_cash</model>
                    <font_size>7</font_size>
                    <display_zero>0</display_zero>
                    <sort_order>651</sort_order>
                </simipos_cash>
            </totals>
        </pdf>
        <fieldsets>
            <sales_convert_quote_address>
                <simipos_cash>
                    <to_order>*</to_order>
                </simipos_cash>
                <simipos_base_cash>
                    <to_order>*</to_order>
                </simipos_base_cash>
                <total_paid>
                    <to_order>*</to_order>
                </total_paid>
                <base_total_paid>
                    <to_order>*</to_order>
                </base_total_paid>
                <total_refunded>
                    <to_order>*</to_order>
                </total_refunded>
                <base_total_refunded>
                    <to_order>*</to_order>
                </base_total_refunded>
            </sales_convert_quote_address>
        </fieldsets>
        <catalog>
            <product>
                <type>
                    <simipos translate="label" module="simipos">
                        <label>Custom Sale</label>
                        <model>simipos/product_type</model>
                        <price_model>simipos/product_price</price_model>
                        <composite>0</composite>
                        <index_priority>100</index_priority>
                    </simipos>
                </type>
            </product>
        </catalog>
    </global>
    <default>
        <simipos>
            <general>
                <enable>1</enable>
                <session_timeout>86400</session_timeout>
            </general>
            <catalog>
                <barcode>simipos_barcode</barcode>
            </catalog>
            <checkout>
                <freeshipping>1</freeshipping>
                <default_shipping>freeshipping</default_shipping>
                <country_id>US</country_id>
                <region_id>1</region_id>
                <allow_discount>1</allow_discount>
            </checkout>
        </simipos>
        <payment>
            <cashin>
                <active>0</active>
                <model>simipos/method_cash</model>
                <order_status>pending</order_status>
                <title>Pay in Cash</title>
                <allowspecific>0</allowspecific>
                <group>offline</group>
            </cashin>
            <payanywhere>
                <active>0</active>
                <model>simipos/method_payanywhere</model>
                <order_status>pending</order_status>
                <title>Credit Card (PayAnywhere)</title>
                <allowspecific>1</allowspecific>
                <specificcountry>US</specificcountry>
                <group>offline</group>
            </payanywhere>
            <paypalhere>
                <active>0</active>
                <model>simipos/method_paypalhere</model>
                <order_status>pending</order_status>
                <title>Paypal Here</title>
                <line_items_enabled>1</line_items_enabled>
                <allowspecific>0</allowspecific>
                <group>offline</group>
                <api_username backend_model="adminhtml/system_config_backend_encrypted"/>
                <api_password backend_model="adminhtml/system_config_backend_encrypted"/>
                <api_signature backend_model="adminhtml/system_config_backend_encrypted"/>
                <accepted_method>cash,card,paypal</accepted_method>
            </paypalhere>
        </payment>
    </default>
</config>
